<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Destinos Leaflet</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
    <style>
        #mapid { height: 400px; }
    </style>
</head>
<body>

<div id="mapid"></div>

<script>
    var map = L.map('mapid').setView([51.505, -0.09], 13);

    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
        attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
    }).addTo(map);

    var blinkingMarkers = [];

    function addBlinkingMarker(e) {
        var marker = L.marker(e.latlng, { draggable: true }).addTo(map);
        var circle = L.circle(e.latlng, { radius: 1000, color: 'red', opacity: 0.5 }).addTo(map);
        blinkingMarkers.push({ marker: marker, circle: circle });

        // Blinking effect
        setInterval(function () {
            circle.setStyle({ opacity: circle.options.opacity === 0.5 ? 0 : 0.5 });
        }, 500);

        marker.on('click', function () {
            setTimeout(function () {
                var confirmDelete = confirm("¿Desea eliminar este destino?");
                if (confirmDelete) {
                    map.removeLayer(marker);
                    map.removeLayer(circle);
                    blinkingMarkers = blinkingMarkers.filter(function (item) {
                        return item.marker !== marker;
                    });
                }
            }, 2000);
        });
    }

    map.on('dblclick', function (e) {
        var addDestination = confirm("¿Desea añadir un destino?");
        if (addDestination) {
            addBlinkingMarker(e);
        }
    });

</script>
</body>
</html>
